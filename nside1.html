<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <title>THE ROOM</title>
    <style>
      body {
        margin: 0;
        overflow: hidden;
      }
      canvas {
        display: block;
      }
    </style>
  </head>
  <body>
    <!-- Background music, hidden -->
    <audio id="bg-music" style="display: none">
      <source src="Assets/Audio/bossa.mp3" type="audio/mpeg" />
      Your browser does not support the audio element.
    </audio>

    <!-- Optional audio toggle button (add it if you want manual control) -->
    <!-- <button id="audio-toggle" style="position: absolute; z-index: 10;">ðŸ”‡</button> -->

    <script>
      window.addEventListener("DOMContentLoaded", () => {
        const music = document.getElementById("bg-music");
        const toggle = document.getElementById("audio-toggle");
    
        if (!music) return;
    
        // Start at random position (once metadata is available)
        music.addEventListener("loadedmetadata", () => {
          music.currentTime = Math.random() * music.duration;
        });
    
        // Optional toggle button
        if (toggle) {
          toggle.addEventListener("click", () => {
            if (music.paused) {
              music.play().then(() => toggle.textContent = "ðŸ”Š").catch(console.warn);
            } else {
              music.pause();
              toggle.textContent = "ðŸ”‡";
            }
          });
        }
    
        // === USER GESTURE NEEDED ===
        const unlockAudio = () => {
          // Create audio context if needed
          if (!window.audioContext) {
            const ctx = new (window.AudioContext || window.webkitAudioContext)();
            window.audioContext = ctx;
          }
    
          const ctx = window.audioContext;
    
          // Resume context if suspended
          if (ctx.state === "suspended") {
            ctx.resume();
          }
    
          // Play the music
          if (music.paused) {
            music.play().then(() => {
              if (toggle) toggle.textContent = "ðŸ”Š";
            }).catch(console.warn);
          }
    
          // Remove listeners after first gesture
          document.removeEventListener("click", unlockAudio);
          document.removeEventListener("touchstart", unlockAudio);
        };
    
        document.addEventListener("click", unlockAudio);
        document.addEventListener("touchstart", unlockAudio);
      });
    </script>
    
    

    <!-- Your Three.js libraries -->
    <script src="libs/three/three.min.js"></script>
    <script src="libs/three/orbit-controls.js"></script>
    <script src="JS/nside-layers.js"></script>
  </body>
</html>
